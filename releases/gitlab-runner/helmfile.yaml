bases:
- ../../environments.yaml

---
repositories:
- name: "gitlab"
  url: "https://charts.gitlab.io"

releases:
- name: gitlab-runner
  chart: gitlab/gitlab-runner
  namespace: "gitlab"
  version: '{{ .Values.helm.gitlab_runner.version }}'
  installed: {{ .Values.helm.gitlab_runner.enabled | toYaml }}
  values:
    - gitlabUrl: https://gitlab.com/
    - runnerRegistrationToken: '{{ .Values.helm.gitlab_runner.token | quote }}'
    - concurrent: {{ .Values.helm.gitlab_runner.concurrent | default 10 }}
    - checkInterval: 30
      ## Configuration for the Pods that the runner launches for each new job
      ##
    - runners:
        ## Default container image to use for builds when none is specified
        ##
        image: alpine:latest
        ## Run all containers with the privileged flag enabled
        ## This will allow the docker:stable-dind image to run if you need to run Docker
        ## commands. Please read the docs before turning this on:
        ## ref: https://docs.gitlab.com/runner/executors/kubernetes.html#using-docker-dind
        ##
        privileged: false
        ## Namespace to run Kubernetes jobs in (defaults to 'default')
        ##
        # namespace:
        ## Build Container specific configuration
        ##
        builds:
          # cpuLimit: 200m
          # memoryLimit: 256Mi
          cpuRequests: 100m
          memoryRequests: 128Mi
        ## Service Container specific configuration
        ##
        services:
          # cpuLimit: 200m
          # memoryLimit: 256Mi
          cpuRequests: 100m
          memoryRequests: 128Mi
        ## Helper Container specific configuration
        ##
        helpers:
          # cpuLimit: 200m
          # memoryLimit: 256Mi
          cpuRequests: 100m
          memoryRequests: 128Mi
